require 'spec_helper'

describe Skydrive::Client do
  before(:each) do
    @client = Skydrive::Client.new(
      client_domain: "test.skydrive.com",
      client_id: "test"
    )
  end

  it "should initialize" do
    opts = {
      client_id: 'id',
      client_secret: 'secret',
      guid: 'asdfjkl',
      token: 'ABCDE',
      foo: 'bar'
    }
    client = Skydrive::Client.new(opts);
    client.client_id.should eq(opts[:client_id])
    client.client_secret.should eq(opts[:client_secret])
    client.guid.should eq(opts[:guid])
    client.token.should eq(opts[:token])
    client.respond_to?(:foo).should_not be_true
  end

  it "#oauth_authorize_redirect_uri" do
    redirect_uri = "http://localhost/auth/redirect"
    state = "abcde"
    redir = @client.oauth_authorize_redirect_uri(redirect_uri, { state: state })
    redir.should eq("https://test.skydrive.com/_layouts/15/OAuthAuthorize.aspx?client_id=test&scope=Web.Read+AllSites.Write+AllProfiles.Read&redirect_uri=http%3A%2F%2Flocalhost%2Fauth%2Fredirect&response_type=code&state=abcde")
  end

  it "#refresh_token" do
    returned_realm = "4xxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
    Skydrive::Client.any_instance.stub(:get_realm).and_return(returned_realm)
    stub_request(:post, "https://accounts.accesscontrol.windows.net/#{returned_realm}/tokens/OAuth/2").
      with(:body => {"client_id"=>"test@#{returned_realm}", "client_secret"=>"", "content_type"=>"application/x-www-form-urlencoded", "grant_type"=>"refresh_token", "refresh_token"=>"NEW_TOKEN", "resource"=>"/test.skydrive.com@#{returned_realm}"},
        :headers => {'Accept'=>'*/*; q=0.5, application/xml', 'Accept-Encoding'=>'gzip, deflate', 'Content-Length'=>'235', 'Content-Type'=>'application/x-www-form-urlencoded', 'User-Agent'=>'Ruby'}).
      to_return(:status => 200, 
        :body => "{\"token_type\":\"Bearer\",\"access_token\":\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\",\"expires_in\":\"43199\",\"not_before\":\"1389210441\",\"expires_on\":\"1389253641\",\"resource\":\"00000003-0000-0ff1-ce00-000000000000/instructure-my.sharepoint.com@4b13a608-c248-4bd1-9017-2794c0d7e5c5\"}",
        :headers => {
          :cache_control=>"no-cache, no-store",
          :pragma=>"no-cache",
          :content_type=>"application/json; charset=utf-8",
          :expires=>"-1",
          :request_id=>"8fa6a09a-354a-4710-8650-e9095e70f8f8",
          :x_content_type_options=>"nosniff",
          :date=>"Wed, 08 Jan 2014 19:47:20 GMT",
          :content_length=>"1183"
        }
      )
    results = @client.refresh_token("NEW_TOKEN")
    results['access_token'].should eq('ABCDEFGHIJKLMNOPQRSTUVWXYZ')
    WebMock.reset!
  end

  it "#format_results" do
    raw_results = "{\"token_type\":\"Bearer\",\"access_token\":\"ABCDEFGHIJKLMNOPQRSTUVWXYZ\",\"expires_in\":\"43199\",\"not_before\":\"1389210441\",\"expires_on\":\"1389253641\",\"resource\":\"00000003-0000-0ff1-ce00-000000000000/instructure-my.sharepoint.com@4b13a608-c248-4bd1-9017-2794c0d7e5c5\"}"
    results = JSON.parse(raw_results)
    modified_results = @client.format_results(results)
    modified_results['expires_in'].should eq(43199)
    modified_results['not_before'].to_s.should eq("2014-01-08 12:47:21 -0700")
    modified_results['expires_on'].to_s.should eq("2014-01-09 00:47:21 -0700")
  end

  it "#get_realm" do
    returned_realm = "4xxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
    stub_request(:get, "https://test.skydrive.com/_vti_bin/client.svc/").
      with(:headers => {'Accept'=>'*/*; q=0.5, application/xml', 'Accept-Encoding'=>'gzip, deflate', 'Authorization'=>'Bearer', 'User-Agent'=>'Ruby'}).
      to_return(:status => 200, :body => "", :headers => { :www_authenticate => "Bearer realm=\"#{returned_realm}\",client_id=\"00000003-0000-0ff1-ce00-000000000000\",trusted_issuers=\"00000001-0000-0000-c000-000000000000@*,https://sts.windows.net/*/,00000003-0000-0ff1-ce00-000000000000@90140122-8516-11e1-8eff-49304924019b\"" })
    realm = @client.get_realm
    realm.should eq(returned_realm)
    WebMock.reset!
  end

  it "#get_folder_and_files" do
    uri1 = "https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/Lists(guid'85208d43-a3be-43ca-a737-f6913578427b')/RootFolder"
    data1 = {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents')", "type"=>"SP.Folder"}, "Files"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents')/Files"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents')/ListItemAllFields"}}, "ParentFolder"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents')/ParentFolder"}}, "Properties"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents')/Properties"}}, "Folders"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents')/Folders"}}, "ItemCount"=>13, "Name"=>"Documents", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents", "WelcomePage"=>""}
    uri2 = "https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents')/Files"
    data2 = {"results"=>[{"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-17_1633.png')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-17_1633.png')", "type"=>"SP.File"}, "Author"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-17_1633.png')/Author"}}, "CheckedOutByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-17_1633.png')/CheckedOutByUser"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-17_1633.png')/ListItemAllFields"}}, "LockedByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-17_1633.png')/LockedByUser"}}, "ModifiedBy"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-17_1633.png')/ModifiedBy"}}, "Versions"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-17_1633.png')/Versions"}}, "CheckInComment"=>"", "CheckOutType"=>2, "ContentTag"=>"{2BD61768-5A77-417D-B16E-1002D414F2F3},1,2", "CustomizedPageStatus"=>0, "ETag"=>"\"{2BD61768-5A77-417D-B16E-1002D414F2F3},1\"", "Exists"=>true, "Length"=>"166006", "Level"=>1, "MajorVersion"=>1, "MinorVersion"=>0, "Name"=>"2013-05-17_1633.png", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-17_1633.png", "TimeCreated"=>"2013-07-29T20:09:09Z", "TimeLastModified"=>"2013-07-29T20:09:09Z", "Title"=>nil, "UIVersion"=>512, "UIVersionLabel"=>"1.0", "UniqueId"=>"2bd61768-5a77-417d-b16e-1002d414f2f3"}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/ember-edit-link.png')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/ember-edit-link.png')", "type"=>"SP.File"}, "Author"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/ember-edit-link.png')/Author"}}, "CheckedOutByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/ember-edit-link.png')/CheckedOutByUser"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/ember-edit-link.png')/ListItemAllFields"}}, "LockedByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/ember-edit-link.png')/LockedByUser"}}, "ModifiedBy"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/ember-edit-link.png')/ModifiedBy"}}, "Versions"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/ember-edit-link.png')/Versions"}}, "CheckInComment"=>"", "CheckOutType"=>2, "ContentTag"=>"{A3B70BED-6038-4C6D-A505-211A0941ACF2},1,2", "CustomizedPageStatus"=>0, "ETag"=>"\"{A3B70BED-6038-4C6D-A505-211A0941ACF2},1\"", "Exists"=>true, "Length"=>"312184", "Level"=>1, "MajorVersion"=>1, "MinorVersion"=>0, "Name"=>"ember-edit-link.png", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/ember-edit-link.png", "TimeCreated"=>"2013-07-29T20:09:08Z", "TimeLastModified"=>"2013-07-29T20:09:08Z", "Title"=>nil, "UIVersion"=>512, "UIVersionLabel"=>"1.0", "UniqueId"=>"a3b70bed-6038-4c6d-a505-211a0941acf2"}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/UtahJS-Logo.eps')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/UtahJS-Logo.eps')", "type"=>"SP.File"}, "Author"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/UtahJS-Logo.eps')/Author"}}, "CheckedOutByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/UtahJS-Logo.eps')/CheckedOutByUser"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/UtahJS-Logo.eps')/ListItemAllFields"}}, "LockedByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/UtahJS-Logo.eps')/LockedByUser"}}, "ModifiedBy"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/UtahJS-Logo.eps')/ModifiedBy"}}, "Versions"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/UtahJS-Logo.eps')/Versions"}}, "CheckInComment"=>"", "CheckOutType"=>2, "ContentTag"=>"{21F6FE98-A05D-4221-9DB2-28F0D6227223},1,1", "CustomizedPageStatus"=>0, "ETag"=>"\"{21F6FE98-A05D-4221-9DB2-28F0D6227223},1\"", "Exists"=>true, "Length"=>"423139", "Level"=>1, "MajorVersion"=>1, "MinorVersion"=>0, "Name"=>"UtahJS-Logo.eps", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/UtahJS-Logo.eps", "TimeCreated"=>"2013-07-22T21:03:02Z", "TimeLastModified"=>"2013-07-22T21:03:02Z", "Title"=>nil, "UIVersion"=>512, "UIVersionLabel"=>"1.0", "UniqueId"=>"21f6fe98-a05d-4221-9db2-28f0d6227223"}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Aloha Loyalty Web Service Implementers Guide.doc')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Aloha%20Loyalty%20Web%20Service%20Implementers%20Guide.doc')", "type"=>"SP.File"}, "Author"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Aloha%20Loyalty%20Web%20Service%20Implementers%20Guide.doc')/Author"}}, "CheckedOutByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Aloha%20Loyalty%20Web%20Service%20Implementers%20Guide.doc')/CheckedOutByUser"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Aloha%20Loyalty%20Web%20Service%20Implementers%20Guide.doc')/ListItemAllFields"}}, "LockedByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Aloha%20Loyalty%20Web%20Service%20Implementers%20Guide.doc')/LockedByUser"}}, "ModifiedBy"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Aloha%20Loyalty%20Web%20Service%20Implementers%20Guide.doc')/ModifiedBy"}}, "Versions"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Aloha%20Loyalty%20Web%20Service%20Implementers%20Guide.doc')/Versions"}}, "CheckInComment"=>"", "CheckOutType"=>2, "ContentTag"=>"{089FC417-D07E-4300-BA64-312889E176D0},1,1", "CustomizedPageStatus"=>0, "ETag"=>"\"{089FC417-D07E-4300-BA64-312889E176D0},1\"", "Exists"=>true, "Length"=>"673792", "Level"=>1, "MajorVersion"=>1, "MinorVersion"=>0, "Name"=>"Aloha Loyalty Web Service Implementers Guide.doc", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/Aloha Loyalty Web Service Implementers Guide.doc", "TimeCreated"=>"2013-07-29T20:09:58Z", "TimeLastModified"=>"2013-07-29T20:09:58Z", "Title"=>"REQ 48382 User-defined Drilldowns", "UIVersion"=>512, "UIVersionLabel"=>"1.0", "UniqueId"=>"089fc417-d07e-4300-ba64-312889e176d0"}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/11 - Marry Me.mp3')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/11%20-%20Marry%20Me.mp3')", "type"=>"SP.File"}, "Author"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/11%20-%20Marry%20Me.mp3')/Author"}}, "CheckedOutByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/11%20-%20Marry%20Me.mp3')/CheckedOutByUser"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/11%20-%20Marry%20Me.mp3')/ListItemAllFields"}}, "LockedByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/11%20-%20Marry%20Me.mp3')/LockedByUser"}}, "ModifiedBy"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/11%20-%20Marry%20Me.mp3')/ModifiedBy"}}, "Versions"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/11%20-%20Marry%20Me.mp3')/Versions"}}, "CheckInComment"=>"", "CheckOutType"=>2, "ContentTag"=>"{CEF6DDAE-10FD-442D-98C7-3C42DDFA3D58},1,1", "CustomizedPageStatus"=>0, "ETag"=>"\"{CEF6DDAE-10FD-442D-98C7-3C42DDFA3D58},1\"", "Exists"=>true, "Length"=>"6153728", "Level"=>1, "MajorVersion"=>1, "MinorVersion"=>0, "Name"=>"11 - Marry Me.mp3", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/11 - Marry Me.mp3", "TimeCreated"=>"2013-07-29T20:09:53Z", "TimeLastModified"=>"2013-07-29T20:09:53Z", "Title"=>nil, "UIVersion"=>512, "UIVersionLabel"=>"1.0", "UniqueId"=>"cef6ddae-10fd-442d-98c7-3c42ddfa3d58"}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/TerryMooreTranscript04042013.pdf')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/TerryMooreTranscript04042013.pdf')", "type"=>"SP.File"}, "Author"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/TerryMooreTranscript04042013.pdf')/Author"}}, "CheckedOutByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/TerryMooreTranscript04042013.pdf')/CheckedOutByUser"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/TerryMooreTranscript04042013.pdf')/ListItemAllFields"}}, "LockedByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/TerryMooreTranscript04042013.pdf')/LockedByUser"}}, "ModifiedBy"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/TerryMooreTranscript04042013.pdf')/ModifiedBy"}}, "Versions"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/TerryMooreTranscript04042013.pdf')/Versions"}}, "CheckInComment"=>"", "CheckOutType"=>2, "ContentTag"=>"{D8331D51-E13E-49F9-BF70-47F6E0D3A308},1,1", "CustomizedPageStatus"=>0, "ETag"=>"\"{D8331D51-E13E-49F9-BF70-47F6E0D3A308},1\"", "Exists"=>true, "Length"=>"294536", "Level"=>1, "MajorVersion"=>1, "MinorVersion"=>0, "Name"=>"TerryMooreTranscript04042013.pdf", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/TerryMooreTranscript04042013.pdf", "TimeCreated"=>"2013-07-22T21:03:19Z", "TimeLastModified"=>"2013-07-22T21:03:19Z", "Title"=>nil, "UIVersion"=>512, "UIVersionLabel"=>"1.0", "UniqueId"=>"d8331d51-e13e-49f9-bf70-47f6e0d3a308"}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/footer-links.png')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/footer-links.png')", "type"=>"SP.File"}, "Author"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/footer-links.png')/Author"}}, "CheckedOutByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/footer-links.png')/CheckedOutByUser"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/footer-links.png')/ListItemAllFields"}}, "LockedByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/footer-links.png')/LockedByUser"}}, "ModifiedBy"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/footer-links.png')/ModifiedBy"}}, "Versions"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/footer-links.png')/Versions"}}, "CheckInComment"=>"", "CheckOutType"=>2, "ContentTag"=>"{709AB6B9-BD72-4E5C-AE0E-50C1AD7D5037},1,2", "CustomizedPageStatus"=>0, "ETag"=>"\"{709AB6B9-BD72-4E5C-AE0E-50C1AD7D5037},1\"", "Exists"=>true, "Length"=>"795", "Level"=>1, "MajorVersion"=>1, "MinorVersion"=>0, "Name"=>"footer-links.png", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/footer-links.png", "TimeCreated"=>"2013-07-29T20:09:09Z", "TimeLastModified"=>"2013-07-29T20:09:09Z", "Title"=>nil, "UIVersion"=>512, "UIVersionLabel"=>"1.0", "UniqueId"=>"709ab6b9-bd72-4e5c-ae0e-50c1ad7d5037"}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Employee Perks.gdoc')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Employee%20Perks.gdoc')", "type"=>"SP.File"}, "Author"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Employee%20Perks.gdoc')/Author"}}, "CheckedOutByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Employee%20Perks.gdoc')/CheckedOutByUser"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Employee%20Perks.gdoc')/ListItemAllFields"}}, "LockedByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Employee%20Perks.gdoc')/LockedByUser"}}, "ModifiedBy"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Employee%20Perks.gdoc')/ModifiedBy"}}, "Versions"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Employee%20Perks.gdoc')/Versions"}}, "CheckInComment"=>"", "CheckOutType"=>2, "ContentTag"=>"{DBC6ABF7-4094-4C20-BA5F-57FB01B2435A},1,1", "CustomizedPageStatus"=>0, "ETag"=>"\"{DBC6ABF7-4094-4C20-BA5F-57FB01B2435A},1\"", "Exists"=>true, "Length"=>"167", "Level"=>1, "MajorVersion"=>1, "MinorVersion"=>0, "Name"=>"Employee Perks.gdoc", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/Employee Perks.gdoc", "TimeCreated"=>"2013-07-29T20:10:04Z", "TimeLastModified"=>"2013-07-29T20:10:04Z", "Title"=>nil, "UIVersion"=>512, "UIVersionLabel"=>"1.0", "UniqueId"=>"dbc6abf7-4094-4c20-ba5f-57fb01b2435a"}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/epf-0.1.3.zip')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/epf-0.1.3.zip')", "type"=>"SP.File"}, "Author"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/epf-0.1.3.zip')/Author"}}, "CheckedOutByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/epf-0.1.3.zip')/CheckedOutByUser"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/epf-0.1.3.zip')/ListItemAllFields"}}, "LockedByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/epf-0.1.3.zip')/LockedByUser"}}, "ModifiedBy"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/epf-0.1.3.zip')/ModifiedBy"}}, "Versions"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/epf-0.1.3.zip')/Versions"}}, "CheckInComment"=>"", "CheckOutType"=>2, "ContentTag"=>"{7DA44B8D-F822-45D0-AD09-8ACCB664FCC8},1,1", "CustomizedPageStatus"=>0, "ETag"=>"\"{7DA44B8D-F822-45D0-AD09-8ACCB664FCC8},1\"", "Exists"=>true, "Length"=>"148060", "Level"=>1, "MajorVersion"=>1, "MinorVersion"=>0, "Name"=>"epf-0.1.3.zip", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/epf-0.1.3.zip", "TimeCreated"=>"2013-07-29T20:10:30Z", "TimeLastModified"=>"2013-07-29T20:10:30Z", "Title"=>nil, "UIVersion"=>512, "UIVersionLabel"=>"1.0", "UniqueId"=>"7da44b8d-f822-45d0-ad09-8accb664fcc8"}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-19_2016.png')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-19_2016.png')", "type"=>"SP.File"}, "Author"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-19_2016.png')/Author"}}, "CheckedOutByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-19_2016.png')/CheckedOutByUser"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-19_2016.png')/ListItemAllFields"}}, "LockedByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-19_2016.png')/LockedByUser"}}, "ModifiedBy"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-19_2016.png')/ModifiedBy"}}, "Versions"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-19_2016.png')/Versions"}}, "CheckInComment"=>"", "CheckOutType"=>2, "ContentTag"=>"{50ADB549-08C3-411C-ACAC-9EA5898E1D15},1,2", "CustomizedPageStatus"=>0, "ETag"=>"\"{50ADB549-08C3-411C-ACAC-9EA5898E1D15},1\"", "Exists"=>true, "Length"=>"300096", "Level"=>1, "MajorVersion"=>1, "MinorVersion"=>0, "Name"=>"2013-05-19_2016.png", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/2013-05-19_2016.png", "TimeCreated"=>"2013-07-29T20:09:09Z", "TimeLastModified"=>"2013-07-29T20:09:09Z", "Title"=>nil, "UIVersion"=>512, "UIVersionLabel"=>"1.0", "UniqueId"=>"50adb549-08c3-411c-acac-9ea5898e1d15"}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/course_activity_1362094997.csv')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/course_activity_1362094997.csv')", "type"=>"SP.File"}, "Author"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/course_activity_1362094997.csv')/Author"}}, "CheckedOutByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/course_activity_1362094997.csv')/CheckedOutByUser"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/course_activity_1362094997.csv')/ListItemAllFields"}}, "LockedByUser"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/course_activity_1362094997.csv')/LockedByUser"}}, "ModifiedBy"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/course_activity_1362094997.csv')/ModifiedBy"}}, "Versions"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFileByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/course_activity_1362094997.csv')/Versions"}}, "CheckInComment"=>"", "CheckOutType"=>2, "ContentTag"=>"{25B9F17B-7BD5-4AFF-9E72-F68A11105962},1,1", "CustomizedPageStatus"=>0, "ETag"=>"\"{25B9F17B-7BD5-4AFF-9E72-F68A11105962},1\"", "Exists"=>true, "Length"=>"2582", "Level"=>1, "MajorVersion"=>1, "MinorVersion"=>0, "Name"=>"course_activity_1362094997.csv", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/course_activity_1362094997.csv", "TimeCreated"=>"2013-07-29T20:10:22Z", "TimeLastModified"=>"2013-07-29T20:10:22Z", "Title"=>nil, "UIVersion"=>512, "UIVersionLabel"=>"1.0", "UniqueId"=>"25b9f17b-7bd5-4aff-9e72-f68a11105962"}]}
    uri3 = "https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents')/Folders"
    data3 = {"results"=>[{"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Pictures')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Pictures')", "type"=>"SP.Folder"}, "Files"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Pictures')/Files"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Pictures')/ListItemAllFields"}}, "ParentFolder"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Pictures')/ParentFolder"}}, "Properties"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Pictures')/Properties"}}, "Folders"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Pictures')/Folders"}}, "ItemCount"=>5, "Name"=>"Pictures", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/Pictures", "WelcomePage"=>""}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Shared with Everyone')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Shared%20with%20Everyone')", "type"=>"SP.Folder"}, "Files"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Shared%20with%20Everyone')/Files"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Shared%20with%20Everyone')/ListItemAllFields"}}, "ParentFolder"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Shared%20with%20Everyone')/ParentFolder"}}, "Properties"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Shared%20with%20Everyone')/Properties"}}, "Folders"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Shared%20with%20Everyone')/Folders"}}, "ItemCount"=>2, "Name"=>"Shared with Everyone", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/Shared with Everyone", "WelcomePage"=>""}, {"__metadata"=>{"id"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Forms')", "uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Forms')", "type"=>"SP.Folder"}, "Files"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Forms')/Files"}}, "ListItemAllFields"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Forms')/ListItemAllFields"}}, "ParentFolder"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Forms')/ParentFolder"}}, "Properties"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Forms')/Properties"}}, "Folders"=>{"__deferred"=>{"uri"=>"https://instructure-my.sharepoint.com/personal/ericb_instructure_onmicrosoft_com/_api/Web/GetFolderByServerRelativeUrl('/personal/ericb_instructure_onmicrosoft_com/Documents/Forms')/Folders"}}, "ItemCount"=>0, "Name"=>"Forms", "ServerRelativeUrl"=>"/personal/ericb_instructure_onmicrosoft_com/Documents/Forms", "WelcomePage"=>""}]}
    Skydrive::Client.any_instance.stub(:api_call).with(uri1).and_return(data1)
    Skydrive::Client.any_instance.stub(:api_call).with(uri2).and_return(data2)
    Skydrive::Client.any_instance.stub(:api_call).with(uri3).and_return(data3)
    results = @client.get_folder_and_files(uri1) 

    results.files.length.should eq(11)
    file_names = results.files.map(&:name)
    file_names.should include "UtahJS-Logo.eps"
    file_names.should include "footer-links.png"

    results.folders.length.should eq(2)
    results.folders.map(&:name).sort.should eq(["Pictures", "Shared with Everyone"])

    WebMock.reset!
  end

end
